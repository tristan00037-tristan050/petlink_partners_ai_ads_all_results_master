<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í«ë§í¬ íŒŒíŠ¸ë„ˆìŠ¤ ì‹œì‘í•˜ê¸°</title>
    
    <!-- í…Œë§ˆ CSS -->
    <link rel="stylesheet" href="/web/shared/theme.css?v=3">
    <!-- ê³µí†µ UI -->
    <link rel="stylesheet" href="/web/shared/ui.css?v=3">
    
    <script src="/web/js/ui.js"></script>
</head>
<body>
    <div style="max-width: 600px; margin: 0 auto; padding: 40px 20px;">
        <!-- ë°°ë„ˆ -->
        <div class="banner">
            ì§€ê¸ˆ ì‹œì‘í•˜ë©´ ì§€ì ë‹¹ â‚©50,000 í¬ë ˆë”§ì´ ìë™ ì§€ê¸‰ë©ë‹ˆë‹¤.
        </div>

        <!-- Step 1: íšŒì›ê°€ì… -->
        <div id="step1" class="card">
            <div class="card-header">
                <h2 class="card-title">íšŒì›ê°€ì…</h2>
                <p class="card-subtitle">ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            </div>
            <div class="card-body">
                <form id="signupForm">
                    <div class="form-group">
                        <label class="form-label">
                            ì´ë©”ì¼ <span class="required">*</span>
                        </label>
                        <input type="email" class="form-input" name="email" required placeholder="example@email.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            ë¹„ë°€ë²ˆí˜¸ <span class="required">*</span>
                        </label>
                        <input type="password" class="form-input" name="password" required placeholder="8ì ì´ìƒ">
                        <div class="form-hint">8ì ì´ìƒ, ì˜ë¬¸/ìˆ«ì/íŠ¹ìˆ˜ë¬¸ì í¬í•¨</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <span class="required">*</span>
                        </label>
                        <input type="password" class="form-input" name="passwordConfirm" required placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥">
                    </div>
                </form>
            </div>
            <div class="card-footer">
                <button type="button" class="btn btn-primary" onclick="goToStep2()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- Step 2: ë§¤ì¥ ì •ë³´ -->
        <div id="step2" class="card" style="display: none;">
            <div class="card-header">
                <h2 class="card-title">ë§¤ì¥ ì •ë³´</h2>
                <p class="card-subtitle">ë§¤ì¥ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
            </div>
            <div class="card-body">
                <form id="storeForm">
                    <div class="form-group">
                        <label class="form-label">
                            ë§¤ì¥ ì´ë¦„ <span class="required">*</span>
                        </label>
                        <input type="text" class="form-input" name="storeName" required placeholder="ì˜ˆ: ê°•ë‚¨ í«ìƒµ">
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            ë§¤ì¥ ì£¼ì†Œ <span class="required">*</span>
                        </label>
                        <input type="text" class="form-input" name="storeAddress" required placeholder="ì˜ˆ: ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123">
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            ì „í™”ë²ˆí˜¸ <span class="required">*</span>
                        </label>
                        <input type="tel" class="form-input" name="phone" required placeholder="ì˜ˆ: 02-1234-5678">
                    </div>
                </form>
            </div>
            <div class="card-footer" style="display: flex; gap: 12px;">
                <button type="button" class="btn btn-outline" onclick="goToStep1()">ì´ì „</button>
                <button type="button" class="btn btn-primary" onclick="goToStep3()">ë‹¤ìŒ</button>
            </div>
        </div>

        <!-- Step 3: ì•½ê´€ ë™ì˜ -->
        <div id="step3" class="card" style="display: none;">
            <div class="card-header">
                <h2 class="card-title">ì•½ê´€ ë™ì˜</h2>
                <p class="card-subtitle">ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”</p>
            </div>
            <div class="card-body">
                <form id="termsForm">
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="terms1" required>
                            <span>ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ <span class="required">*</span></span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="terms2" required>
                            <span>ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ <span class="required">*</span></span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="terms3">
                            <span>ë§ˆì¼€íŒ… í™œìš© ë™ì˜ (ì„ íƒ)</span>
                        </label>
                    </div>
                    <div style="margin-top: 16px;">
                        <label class="checkbox-label">
                            <input type="checkbox" id="allAgree" onchange="toggleAllTerms(this.checked)">
                            <span style="font-weight: 600;">ëª¨ë‘ ë™ì˜</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="card-footer" style="display: flex; gap: 12px;">
                <button type="button" class="btn btn-outline" onclick="goToStep2()">ì´ì „</button>
                <button type="button" class="btn btn-primary" onclick="completeOnboarding()">ì™„ë£Œ</button>
            </div>
        </div>

        <!-- Step 4: ì™„ë£Œ -->
        <div id="step4" class="card" style="display: none; text-align: center;">
            <div class="card-header">
                <h2 class="card-title">ê°€ì… ì™„ë£Œ!</h2>
                <p class="card-subtitle">30ì¼ ë¬´ë£Œ ì²´í—˜ê³¼ ì§€ì ë‹¹ â‚©50,000 í¬ë ˆë”§ì´ ìë™ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            </div>
            <div class="card-body">
                <div style="font-size: 48px; margin-bottom: 24px;">ğŸ‰</div>
            </div>
            <div class="card-footer" style="display: flex; gap: 12px; justify-content: center;">
                <a href="/index.html" class="btn btn-primary">ëŒ€ì‹œë³´ë“œë¡œ</a>
                <a href="/web/pages/animals_create.html" class="btn btn-secondary">30ì¼ ë¬´ë£Œ ì‹œì‘</a>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;

        function goToStep2() {
            const form = document.getElementById('signupForm');
            if (!UI.validateForm(form)) {
                UI.showToast('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            const password = form.password.value;
            const passwordConfirm = form.passwordConfirm.value;
            
            if (password !== passwordConfirm) {
                UI.showToast('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                return;
            }
            
            if (password.length < 8) {
                UI.showToast('ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
                return;
            }
            
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
            currentStep = 2;
        }

        function goToStep1() {
            document.getElementById('step2').style.display = 'none';
            document.getElementById('step1').style.display = 'block';
            currentStep = 1;
        }

        function goToStep3() {
            const form = document.getElementById('storeForm');
            if (!UI.validateForm(form)) {
                UI.showToast('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            document.getElementById('step2').style.display = 'none';
            document.getElementById('step3').style.display = 'block';
            currentStep = 3;
        }

        function toggleAllTerms(checked) {
            const checkboxes = document.querySelectorAll('#termsForm input[type="checkbox"]');
            checkboxes.forEach(cb => {
                if (cb.id !== 'allAgree') {
                    cb.checked = checked;
                }
            });
        }

        async function completeOnboarding() {
            const form = document.getElementById('termsForm');
            const terms1 = form.terms1.checked;
            const terms2 = form.terms2.checked;
            
            if (!terms1 || !terms2) {
                UI.showToast('í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            // íšŒì›ê°€ì… API í˜¸ì¶œ
            try {
                const signupData = {
                    email: document.getElementById('signupForm').email.value,
                    password: document.getElementById('signupForm').password.value,
                    store_name: document.getElementById('storeForm').storeName.value,
                    store_address: document.getElementById('storeForm').storeAddress.value,
                    phone: document.getElementById('storeForm').phone.value,
                    terms_agreed: { terms1, terms2, terms3: form.terms3.checked }
                };
                
                const response = await fetch('http://localhost:3001/auth/signup', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(signupData)
                });
                
                const result = await response.json();
                
                if (result.ok) {
                    document.getElementById('step3').style.display = 'none';
                    document.getElementById('step4').style.display = 'block';
                    currentStep = 4;
                } else {
                    UI.showToast(result.error || 'ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                }
            } catch (error) {
                console.error('Signup error:', error);
                UI.showToast('ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }
    </script>
</body>
</html>

